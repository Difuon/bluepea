{
	"version": 3,
	"file": "C:/Users/elong/AdHoc/bluepea/src/bluepea/static/pylib/__javascript__/pylib.inspector.mod.js",
	"sources": [
		"C:/Users/elong/AdHoc/bluepea/src/bluepea/static/pylib/inspector.py"
	],
	"sourcesContent": [
		"\"\"\"\nInspector page, used for viewing objects in the database.\n\"\"\"\n\n\nclass Tab:\n    \"\"\"\n    Base class of tabs, including the menu link and the displayed tab itself.\n    \"\"\"\n    Name = \"\"\n    \"\"\"Friendly name to be displayed in the menu.\"\"\"\n    Data_tab = \"\"\n    \"\"\"Tab identifier, used as html attribute 'data-tab'.\"\"\"\n    Active = False\n    \"\"\"True if this Tab should be displayed on startup.\"\"\"\n\n    def __init__(self):\n        self._menu_attrs = {\"data-tab\": self.Data_tab}\n        self._tab_attrs = {\"data-tab\": self.Data_tab}\n        self._menu = \"a.item\"\n        self._tab = \"div.ui.bottom.attached.tab.segment\"\n\n        if self.Active:\n            self._menu += \".active\"\n            self._tab += \".active\"\n\n    def menu_item(self):\n        \"\"\"\n        Returns a vnode <a> item, for use in the tab menu.\n        \"\"\"\n        return m(self._menu, self._menu_attrs, self.Name)\n\n    def tab_item(self):\n        \"\"\"\n        Returns a vnode tab wrapper around the contents of the tab itself.\n        \"\"\"\n        return m(self._tab, self._tab_attrs, self.main_view())\n\n    def main_view(self):\n        \"\"\"\n        Returns the vnode of the actual tab contents.\n        \"\"\"\n        return m(\"div\", \"hello \" + self.Name)\n\n\nclass TabledTab(Tab):\n    \"\"\"\n    Base class for tabs in the Inspector interface, using a table and \"details\" view.\n    \"\"\"\n    def __init__(self):\n        super().__init__()\n        self.table = None\n        self.setup_table()\n        self.copiedDetails = \"\"\n\n    def setup_table(self):\n        \"\"\"\n        Called on startup for the purpose of creating the Table object.\n        \"\"\"\n        pass\n\n    def _copyDetails(self):\n        self.copiedDetails = self.table.detailSelected\n\n    def _clearCopy(self):\n        self.copiedDetails = \"\"\n\n    def main_view(self):\n        return m(\"div\",\n                 # Table needs to be in a special container to handle scrolling/sticky table header\n                 m(\"div.table-container\", m(self.table.view)),\n                 m(\"div.ui.hidden.divider\"),\n                 m(\"div.ui.two.cards\", {\"style\": \"height: 45%;\"},\n                   m(\"div.ui.card\",\n                     m(\"div.content.small-header\",\n                       m(\"div.header\",\n                         m(\"span\", \"Details\"),\n                         m(\"span.ui.mini.right.floated.button\", {\"onclick\": self._copyDetails}, \"Copy\")\n                         )\n                       ),\n                     m(\"pre.content.code-block\",\n                       self.table.detailSelected\n                       )\n                     ),\n                   m(\"div.ui.card\",\n                     m(\"div.content.small-header\",\n                       m(\"div.header\",\n                         m(\"span\", \"Copied\"),\n                         m(\"span.ui.mini.right.floated.button\", {\"onclick\": self._clearCopy}, \"Clear\")\n                         )\n                       ),\n                     m(\"pre.content.code-block\",\n                       self.copiedDetails\n                       )\n                     )\n                   )\n                 )\n\n\nclass Field:\n    \"\"\"\n    A field/column of a table.\n    \"\"\"\n    Name = None\n    \"\"\"Friendly name to display in table header.\"\"\"\n\n    def __init__(self, name=None):\n        self.name = self.Name\n        if name is not None:\n            self.name = name\n\n    def format(self, string):\n        \"\"\"\n        Formats the string to match the expected view for this field.\n        \"\"\"\n        if len(string) > 8:\n            string = string[:5] + \"...\"\n        return string\n\n    def view(self, data):\n        \"\"\"\n        Returns a vnode <td> suitable for display in a table.\n        \"\"\"\n        return m(\"td\", {\"title\": data}, self.format(data))\n\n\nclass Table:\n    \"\"\"\n    A table, its headers, and its data to be displayed.\n    \"\"\"\n    def __init__(self, fields):\n        self.max_size = 8\n        self.fields = fields\n        self.data = {}\n        self.view = {\n            \"oninit\": self._oninit,\n            \"view\": self._view\n        }\n        self._selectedRow = None\n        self._selectedUid = None\n        self.detailSelected = \"\"\n\n    def _selectRow(self, event, uid):\n        \"\"\"\n        Deselects any previously selected row and\n        selects the row specified in the event.\n        \"\"\"\n        if uid == self._selectedUid:\n            return\n\n        self._selectedUid = uid\n\n        if self._selectedRow is not None:\n            jQuery(self._selectedRow).removeClass(\"active\")\n\n        self._selectedRow = event.currentTarget\n        jQuery(self._selectedRow).addClass(\"active\")\n\n        self.detailSelected = JSON.stringify(self.data[uid], None, 2)\n\n    def _oninit(self):\n        \"\"\"\n        Loads any initial data.\n        \"\"\"\n        for i in range(20):\n            obj = {}\n            for field in self.fields:\n                obj[field.name] = \"test{0} {1}\".format(i, field.name)\n            self.data[i] = obj\n\n    def _view(self):\n        headers = [m(\"th\", field.name) for field in self.fields]\n\n        # Create the rows of the table\n        rows = []\n        for i, key in enumerate(self.data.keys()):\n            if i >= self.max_size:\n                rows.append(m(\"tr\", m(\"td\", \"Limited to {} results.\".format(self.max_size))))\n                break\n\n            obj = self.data[key]\n            # Format each cell based on the corresponding Field\n            row = [field.view(obj[field.name]) for field in self.fields]\n\n            # Needed so we can pass through the key as-is to the lambda, without it changing through the loop\n            def makeScope(uid):\n                return lambda event: self._selectRow(event, uid)\n            rows.append(m(\"tr\", {\"onclick\": makeScope(key)}, row))\n\n        return m(\"table\", {\"class\": \"ui selectable celled unstackable single line left aligned table\"},\n                 m(\"thead\",\n                   m(\"tr\", {\"class\": \"center aligned\"}, headers)\n                   ),\n                 m(\"tbody\",\n                   rows\n                   )\n                 )\n\n\nclass Entities(TabledTab):\n    Name = \"Entities\"\n    Data_tab = \"entities\"\n    Active = True\n\n    def setup_table(self):\n        fields = [Field(x) for x in [\"DID\", \"HID\", \"Signer\", \"Changed\", \"Issuants\", \"Data\", \"Keys\"]]\n        self.table = Table(fields)\n\n\nclass Issuants(Tab):\n    Name = \"Issuants\"\n    Data_tab = \"issuants\"\n\n\nclass Offers(Tab):\n    Name = \"Offers\"\n    Data_tab = \"offers\"\n\n\nclass Messages(Tab):\n    Name = \"Messages\"\n    Data_tab = \"messages\"\n\n\nclass AnonMsgs(Tab):\n    Name = \"Anon Msgs\"\n    Data_tab = \"anonmsgs\"\n\n\nclass Tabs:\n    \"\"\"\n    Manages the displayed tabs.\n    \"\"\"\n    def __init__(self):\n        self.tabs = [Entities(), Issuants(), Offers(), Messages(), AnonMsgs()]\n        self._searchId = \"inspectorSearchId\"\n\n        # Required to activate tab functionality (so clicking a menu item will activate that tab)\n        jQuery(document).ready(lambda: jQuery('.menu .item').tab())\n\n    def search(self):\n        text = jQuery(\"#\" + self._searchId).val()\n        #todo search for text in current tab's data\n\n    def searchWithin(self):\n        text = jQuery(\"#\" + self._searchId).val()\n        #todo search for text in all tabs' data\n\n    def view(self):\n        menu_items = []\n        tab_items = []\n        for tab in self.tabs:\n            menu_items.append(tab.menu_item())\n            tab_items.append(tab.tab_item())\n\n        return m(\"div\",\n                 m(\"form\", {\"onsubmit\": self.search},\n                   m(\"div.ui.borderless.menu\",\n                     m(\"div.right.menu\", {\"style\": \"padding-right: 40%\"},\n                       m(\"div.item\", {\"style\": \"width: 80%\"},\n                         m(\"div.ui.transparent.icon.input\",\n                           m(\"input[type=text][placeholder=Search...]\", {\"id\": self._searchId}),\n                           m(\"i.search.icon\")\n                           )\n                         ),\n                       m(\"div.item\",\n                         m(\"input.ui.primary.button[type=submit][value=Search]\")\n                         ),\n                       m(\"div.item\",\n                         m(\"div.ui.secondary.button\", {\"onclick\": self.searchWithin}, \"Search Within\")\n                         )\n                       )\n                     ),\n                   ),\n                 m(\"div.ui.top.attached.pointing.five.item.menu\",\n                   menu_items\n                   ),\n                 tab_items\n                 )\n\n\ntabs = Tabs()\nRenderer = {\n    \"render\": tabs.view\n}\n"
	],
	"mappings": "AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAIA;AAEA;AAEA;AAGA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAIA;AAIA;AAAA;AAEA;AAIA;AAAA;AAEA;AAIA;AAAA;AAAA;AAGA;AAIA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAIA;AAAA;AAEA;AACA;AAAA;AAEA;AACA;AAAA;AAEA;AAwBA;AAAA;AAAA;AAQA;AAIA;AAGA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AAIA;AACA;AAAA;AACA;AAAA;AAEA;AAIA;AAAA;AAAA;AAGA;AAIA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AAAA;AAEA;AAKA;AACA;AAAA;AAEA;AAEA;AACA;AAAA;AAEA;AACA;AAEA;AAAA;AAEA;AAIA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAGA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAMA;AAAA;AAAA;AAMA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAGA;AACA;AACA;AAAA;AAGA;AACA;AACA;AAAA;AAGA;AACA;AACA;AAAA;AAGA;AACA;AACA;AAAA;AAGA;AAIA;AACA;AACA;AAGA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAGA;AACA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAqBA;AAAA;AAAA;AAOA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA"
}